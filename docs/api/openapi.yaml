openapi: 3.0.3
info:
  title: ã¨ã¡ã¾ã¡ (Tochimachi) API
  description: |
    æ ƒæœ¨çœŒãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆã€Œã¨ã¡ã¾ã¡ã€ã®RESTful APIä»•æ§˜æ›¸

    ## èªè¨¼ã«ã¤ã„ã¦
    - æ¥­è€…å‘ã‘API: Bearer Tokenã«ã‚ˆã‚‹èªè¨¼ãŒå¿…è¦
    - ç®¡ç†è€…API: JWTèªè¨¼ + RBAC (Role-Based Access Control)
    - é¡§å®¢å‘ã‘API: èªè¨¼ä¸è¦ï¼ˆä¸€éƒ¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ï¼‰

    ## ãƒ¬ãƒ¼ãƒˆåˆ¶é™
    - èªè¨¼ãªã—: 100 requests/hour
    - èªè¨¼æ¸ˆã¿: 1000 requests/hour
    - ç®¡ç†è€…: åˆ¶é™ãªã—

    ## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
    ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ä»¥ä¸‹ã®å½¢å¼ã«å¾“ã„ã¾ã™:
    ```json
    {
      "error": {
        "code": "ERROR_CODE",
        "message": "Human-readable error message",
        "details": {}
      }
    }
    ```
  version: 1.0.0
  contact:
    name: Tochimachi API Support
    email: api@tochimachi.jp
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: https://api.tochimachi.jp/v1
    description: Production server
  - url: https://staging-api.tochimachi.jp/v1
    description: Staging server
  - url: http://localhost:3000/api/v1
    description: Local development server

tags:
  - name: Categories
    description: ã‚«ãƒ†ã‚´ãƒªç®¡ç†ï¼ˆãƒ˜ã‚¢ã‚µãƒ­ãƒ³ã€ä¸å‹•ç”£ã€é£²é£Ÿåº—ãªã©ï¼‰
  - name: Vendors
    description: æ¥­è€…æƒ…å ±ã®æ¤œç´¢ãƒ»è¡¨ç¤º
  - name: Services
    description: ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±
  - name: Inquiries
    description: å•ã„åˆã‚ã›ç®¡ç†
  - name: Cart
    description: ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½
  - name: Vendor Auth
    description: æ¥­è€…èªè¨¼ãƒ»ç™»éŒ²
  - name: Vendor Management
    description: æ¥­è€…ç®¡ç†æ©Ÿèƒ½
  - name: Instagram
    description: Instagramé€£æº
  - name: Admin
    description: ç®¡ç†è€…æ©Ÿèƒ½
  - name: Analytics
    description: åˆ†æãƒ‡ãƒ¼ã‚¿

paths:
  # =========================================
  # é¡§å®¢å‘ã‘API
  # =========================================

  /categories:
    get:
      summary: ã‚«ãƒ†ã‚´ãƒªä¸€è¦§å–å¾—
      description: ã™ã¹ã¦ã®ã‚«ãƒ†ã‚´ãƒªã‚’å–å¾—ã—ã¾ã™ï¼ˆãƒ˜ã‚¢ã‚µãƒ­ãƒ³ã€ä¸å‹•ç”£ã€é£²é£Ÿåº—ãªã©ï¼‰
      operationId: getCategories
      tags:
        - Categories
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Category'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
              example:
                data:
                  - id: "cat_001"
                    name: "ãƒ˜ã‚¢ã‚µãƒ­ãƒ³"
                    slug: "hair-salon"
                    icon: "âœ‚ï¸"
                    description: "ç¾å®¹é™¢ã€ç†å®¹å®¤ãªã©ã®ãƒ˜ã‚¢ã‚µãƒ­ãƒ³"
                    vendorCount: 45
                    createdAt: "2025-01-01T00:00:00Z"
                  - id: "cat_002"
                    name: "ä¸å‹•ç”£"
                    slug: "real-estate"
                    icon: "ğŸ "
                    description: "è³ƒè²¸ã€å£²è²·ã€ç®¡ç†ä¼šç¤¾ãªã©"
                    vendorCount: 32
                    createdAt: "2025-01-01T00:00:00Z"
                meta:
                  total: 15
                  page: 1
                  limit: 10

  /vendors:
    get:
      summary: æ¥­è€…æ¤œç´¢ãƒ»ä¸€è¦§å–å¾—
      description: |
        æ¥­è€…ã‚’æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦å–å¾—ã—ã¾ã™ã€‚
        ã‚«ãƒ†ã‚´ãƒªã€ã‚¨ãƒªã‚¢ã€ä¾¡æ ¼å¸¯ãªã©ã§çµã‚Šè¾¼ã¿å¯èƒ½ã€‚
      operationId: getVendors
      tags:
        - Vendors
      parameters:
        - name: category
          in: query
          description: ã‚«ãƒ†ã‚´ãƒªSlugï¼ˆä¾‹: hair-salonï¼‰
          schema:
            type: string
        - name: area
          in: query
          description: ã‚¨ãƒªã‚¢ï¼ˆä¾‹: å®‡éƒ½å®®å¸‚ï¼‰
          schema:
            type: string
        - name: priceRange
          in: query
          description: ä¾¡æ ¼å¸¯ï¼ˆä¾‹: 5000-10000ï¼‰
          schema:
            type: string
        - name: search
          in: query
          description: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
          schema:
            type: string
        - name: sortBy
          in: query
          description: ã‚½ãƒ¼ãƒˆåŸºæº–
          schema:
            type: string
            enum: [rating, createdAt, price, popularity]
            default: rating
        - name: page
          in: query
          description: ãƒšãƒ¼ã‚¸ç•ªå·
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•°
          schema:
            type: integer
            default: 20
            maximum: 100
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Vendor'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '400':
          $ref: '#/components/responses/BadRequest'

  /vendors/{vendorId}:
    get:
      summary: æ¥­è€…è©³ç´°å–å¾—
      description: æŒ‡å®šã•ã‚ŒãŸæ¥­è€…ã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™
      operationId: getVendorById
      tags:
        - Vendors
      parameters:
        - name: vendorId
          in: path
          required: true
          description: æ¥­è€…ID
          schema:
            type: string
            example: "vendor_001"
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/VendorDetail'
        '404':
          $ref: '#/components/responses/NotFound'

  /vendors/{vendorId}/services:
    get:
      summary: ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§å–å¾—
      description: æŒ‡å®šã•ã‚ŒãŸæ¥­è€…ã®ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ã‚’å–å¾—ã—ã¾ã™
      operationId: getVendorServices
      tags:
        - Services
      parameters:
        - name: vendorId
          in: path
          required: true
          description: æ¥­è€…ID
          schema:
            type: string
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Service'
        '404':
          $ref: '#/components/responses/NotFound'

  /vendors/{vendorId}/instagram:
    get:
      summary: InstagramæŠ•ç¨¿å–å¾—
      description: æ¥­è€…ã®InstagramæŠ•ç¨¿ã‚’å–å¾—ã—ã¾ã™ï¼ˆé€£æºæ¸ˆã¿ã®å ´åˆï¼‰
      operationId: getVendorInstagramPosts
      tags:
        - Instagram
      parameters:
        - name: vendorId
          in: path
          required: true
          description: æ¥­è€…ID
          schema:
            type: string
        - name: limit
          in: query
          description: å–å¾—ä»¶æ•°
          schema:
            type: integer
            default: 12
            maximum: 50
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstagramPost'
                  meta:
                    type: object
                    properties:
                      username:
                        type: string
                      followersCount:
                        type: integer
                      isConnected:
                        type: boolean
        '404':
          $ref: '#/components/responses/NotFound'

  /inquiries:
    post:
      summary: ä¸€æ‹¬å•ã„åˆã‚ã›é€ä¿¡
      description: |
        è¤‡æ•°ã®æ¥­è€…ã«ä¸€æ‹¬ã§å•ã„åˆã‚ã›ã‚’é€ä¿¡ã—ã¾ã™ã€‚
        ã‚«ãƒ¼ãƒˆå†…ã®æ¥­è€…ã«å¯¾ã—ã¦åŒä¸€å†…å®¹ã‚’é€ä¿¡å¯èƒ½ã€‚
      operationId: createInquiry
      tags:
        - Inquiries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InquiryRequest'
      responses:
        '201':
          description: å•ã„åˆã‚ã›é€ä¿¡æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      inquiryId:
                        type: string
                      vendorIds:
                        type: array
                        items:
                          type: string
                      status:
                        type: string
                        enum: [sent, pending]
                      createdAt:
                        type: string
                        format: date-time
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'

  /cart:
    get:
      summary: ã‚«ãƒ¼ãƒˆå–å¾—
      description: ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚«ãƒ¼ãƒˆå†…å®¹ã‚’å–å¾—ã—ã¾ã™
      operationId: getCart
      tags:
        - Cart
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/Cart'

  /cart/items:
    post:
      summary: ã‚«ãƒ¼ãƒˆã«æ¥­è€…è¿½åŠ 
      description: ã‚«ãƒ¼ãƒˆã«æ¥­è€…ã‚’è¿½åŠ ã—ã¾ã™ï¼ˆå•ã„åˆã‚ã›å¯¾è±¡ã¨ã—ã¦ï¼‰
      operationId: addToCart
      tags:
        - Cart
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - vendorId
              properties:
                vendorId:
                  type: string
                  description: è¿½åŠ ã™ã‚‹æ¥­è€…ID
                serviceId:
                  type: string
                  description: ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼šç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã‚’æŒ‡å®š
      responses:
        '201':
          description: è¿½åŠ æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/Cart'
        '400':
          $ref: '#/components/responses/BadRequest'

  /cart/items/{cartItemId}:
    delete:
      summary: ã‚«ãƒ¼ãƒˆã‹ã‚‰å‰Šé™¤
      description: ã‚«ãƒ¼ãƒˆã‹ã‚‰æ¥­è€…ã‚’å‰Šé™¤ã—ã¾ã™
      operationId: removeFromCart
      tags:
        - Cart
      parameters:
        - name: cartItemId
          in: path
          required: true
          description: ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ ID
          schema:
            type: string
      responses:
        '204':
          description: å‰Šé™¤æˆåŠŸ
        '404':
          $ref: '#/components/responses/NotFound'

  # =========================================
  # æ¥­è€…å‘ã‘API
  # =========================================

  /auth/vendor/register:
    post:
      summary: æ¥­è€…ç™»éŒ²
      description: æ–°è¦æ¥­è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™»éŒ²ã—ã¾ã™
      operationId: registerVendor
      tags:
        - Vendor Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VendorRegisterRequest'
      responses:
        '201':
          description: ç™»éŒ²æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      vendorId:
                        type: string
                      status:
                        type: string
                        enum: [pending, approved]
                      message:
                        type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯æ¥­è€…åãŒæ—¢ã«å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/vendor/login:
    post:
      summary: æ¥­è€…ãƒ­ã‚°ã‚¤ãƒ³
      description: æ¥­è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
      operationId: vendorLogin
      tags:
        - Vendor Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
      responses:
        '200':
          description: ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      accessToken:
                        type: string
                      refreshToken:
                        type: string
                      expiresIn:
                        type: integer
                      vendorId:
                        type: string
        '401':
          $ref: '#/components/responses/Unauthorized'

  /vendor/profile:
    get:
      summary: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—
      description: ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®æ¥­è€…ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’å–å¾—
      operationId: getVendorProfile
      tags:
        - Vendor Management
      security:
        - BearerAuth: []
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/VendorProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'

    put:
      summary: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°
      description: æ¥­è€…ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’æ›´æ–°
      operationId: updateVendorProfile
      tags:
        - Vendor Management
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VendorProfileUpdateRequest'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/VendorProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /vendor/services:
    get:
      summary: ã‚µãƒ¼ãƒ“ã‚¹ç®¡ç†ä¸€è¦§
      description: è‡ªç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ã‚’å–å¾—
      operationId: getMyServices
      tags:
        - Vendor Management
      security:
        - BearerAuth: []
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Service'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      summary: ã‚µãƒ¼ãƒ“ã‚¹è¿½åŠ 
      description: æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¿½åŠ 
      operationId: createService
      tags:
        - Vendor Management
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceCreateRequest'
      responses:
        '201':
          description: ä½œæˆæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/Service'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /vendor/inquiries:
    get:
      summary: å•ã„åˆã‚ã›ä¸€è¦§
      description: è‡ªç¤¾ã«å±Šã„ãŸå•ã„åˆã‚ã›ä¸€è¦§ã‚’å–å¾—
      operationId: getVendorInquiries
      tags:
        - Vendor Management
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          description: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ•ã‚£ãƒ«ã‚¿
          schema:
            type: string
            enum: [unread, read, replied]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InquiryReceived'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /vendor/instagram/connect:
    post:
      summary: Instagramé€£æº
      description: Instagram ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æº
      operationId: connectInstagram
      tags:
        - Instagram
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - accessToken
              properties:
                accessToken:
                  type: string
                  description: Instagram OAuth access token
                username:
                  type: string
      responses:
        '200':
          description: é€£æºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      isConnected:
                        type: boolean
                      username:
                        type: string
                      profilePictureUrl:
                        type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # =========================================
  # ç®¡ç†è€…API
  # =========================================

  /admin/vendors:
    get:
      summary: æ¥­è€…ç®¡ç†ä¸€è¦§
      description: ã™ã¹ã¦ã®æ¥­è€…ã‚’ç®¡ç†è€…ãŒé–²è¦§
      operationId: adminGetVendors
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          description: æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ•ã‚£ãƒ«ã‚¿
          schema:
            type: string
            enum: [pending, approved, rejected, suspended]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/VendorAdmin'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/vendors/{vendorId}/approve:
    put:
      summary: æ¥­è€…æ‰¿èª
      description: æ¥­è€…ç™»éŒ²ç”³è«‹ã‚’æ‰¿èª
      operationId: approveVendor
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: vendorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [approved, rejected]
                reason:
                  type: string
                  description: å´ä¸‹ç†ç”±ï¼ˆrejectedã®å ´åˆå¿…é ˆï¼‰
      responses:
        '200':
          description: å‡¦ç†æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      vendorId:
                        type: string
                      status:
                        type: string
                      updatedAt:
                        type: string
                        format: date-time
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  /admin/subscriptions:
    get:
      summary: èª²é‡‘ç®¡ç†ä¸€è¦§
      description: ã™ã¹ã¦ã®èª²é‡‘ãƒ»ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—
      operationId: adminGetSubscriptions
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [active, expired, canceled]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Subscription'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/analytics:
    get:
      summary: åˆ†æãƒ‡ãƒ¼ã‚¿å–å¾—
      description: ã‚µã‚¤ãƒˆå…¨ä½“ã®åˆ†æãƒ‡ãƒ¼ã‚¿ï¼ˆPVã€CVã€å£²ä¸Šãªã©ï¼‰ã‚’å–å¾—
      operationId: getAnalytics
      tags:
        - Analytics
      security:
        - BearerAuth: []
      parameters:
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: metric
          in: query
          description: å–å¾—ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹
          schema:
            type: string
            enum: [pageviews, inquiries, revenue, vendors]
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/Analytics'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/waitlist:
    get:
      summary: ã‚¦ã‚§ã‚¤ãƒˆãƒªã‚¹ãƒˆå–å¾—
      description: ã‚µãƒ¼ãƒ“ã‚¹é–‹å§‹å‰ã®ã‚¦ã‚§ã‚¤ãƒˆãƒªã‚¹ãƒˆç™»éŒ²è€…ã‚’å–å¾—
      operationId: getWaitlist
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/WaitlistEntry'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

# =========================================
# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®šç¾©
# =========================================

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer Tokenèªè¨¼

  schemas:
    # å…±é€šã‚¹ã‚­ãƒ¼ãƒ
    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              example: "VALIDATION_ERROR"
            message:
              type: string
              example: "Validation failed"
            details:
              type: object
              additionalProperties: true

    PaginationMeta:
      type: object
      properties:
        total:
          type: integer
          description: ç·ä»¶æ•°
        page:
          type: integer
          description: ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ç•ªå·
        limit:
          type: integer
          description: 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•°
        totalPages:
          type: integer
          description: ç·ãƒšãƒ¼ã‚¸æ•°

    # ã‚«ãƒ†ã‚´ãƒª
    Category:
      type: object
      required:
        - id
        - name
        - slug
      properties:
        id:
          type: string
          example: "cat_001"
        name:
          type: string
          example: "ãƒ˜ã‚¢ã‚µãƒ­ãƒ³"
        slug:
          type: string
          example: "hair-salon"
        icon:
          type: string
          example: "âœ‚ï¸"
        description:
          type: string
        vendorCount:
          type: integer
          description: ã“ã®ã‚«ãƒ†ã‚´ãƒªã®æ¥­è€…æ•°
        createdAt:
          type: string
          format: date-time

    # æ¥­è€…
    Vendor:
      type: object
      required:
        - id
        - name
        - category
      properties:
        id:
          type: string
          example: "vendor_001"
        name:
          type: string
          example: "ç¾å®¹å®¤ã‚µãƒ³ãƒ—ãƒ«"
        category:
          $ref: '#/components/schemas/Category'
        area:
          type: string
          example: "å®‡éƒ½å®®å¸‚"
        rating:
          type: number
          format: float
          example: 4.5
          minimum: 0
          maximum: 5
        reviewCount:
          type: integer
          example: 128
        thumbnailUrl:
          type: string
          format: uri
        priceRange:
          type: string
          example: "Â¥Â¥"
          enum: ["Â¥", "Â¥Â¥", "Â¥Â¥Â¥"]
        isInstagramConnected:
          type: boolean
        tags:
          type: array
          items:
            type: string
          example: ["é§è»Šå ´ã‚ã‚Š", "ã‚­ãƒƒã‚ºãƒ«ãƒ¼ãƒ "]

    VendorDetail:
      allOf:
        - $ref: '#/components/schemas/Vendor'
        - type: object
          properties:
            description:
              type: string
            address:
              type: string
            phone:
              type: string
            email:
              type: string
              format: email
            website:
              type: string
              format: uri
            openingHours:
              type: object
              additionalProperties:
                type: string
              example:
                monday: "9:00-18:00"
                tuesday: "9:00-18:00"
                wednesday: "å®šä¼‘æ—¥"
            images:
              type: array
              items:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                  caption:
                    type: string
            services:
              type: array
              items:
                $ref: '#/components/schemas/Service'
            reviews:
              type: array
              items:
                $ref: '#/components/schemas/Review'

    # ã‚µãƒ¼ãƒ“ã‚¹
    Service:
      type: object
      required:
        - id
        - name
        - price
      properties:
        id:
          type: string
          example: "svc_001"
        name:
          type: string
          example: "ã‚«ãƒƒãƒˆï¼†ã‚«ãƒ©ãƒ¼"
        description:
          type: string
        price:
          type: integer
          example: 8000
          description: ä¾¡æ ¼ï¼ˆå††ï¼‰
        duration:
          type: integer
          example: 90
          description: æ‰€è¦æ™‚é–“ï¼ˆåˆ†ï¼‰
        imageUrl:
          type: string
          format: uri
        createdAt:
          type: string
          format: date-time

    # ãƒ¬ãƒ“ãƒ¥ãƒ¼
    Review:
      type: object
      properties:
        id:
          type: string
        customerName:
          type: string
          example: "åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼"
        rating:
          type: integer
          minimum: 1
          maximum: 5
        comment:
          type: string
        createdAt:
          type: string
          format: date-time

    # InstagramæŠ•ç¨¿
    InstagramPost:
      type: object
      properties:
        id:
          type: string
        mediaType:
          type: string
          enum: [IMAGE, VIDEO, CAROUSEL_ALBUM]
        mediaUrl:
          type: string
          format: uri
        caption:
          type: string
        permalink:
          type: string
          format: uri
        timestamp:
          type: string
          format: date-time
        likeCount:
          type: integer
        commentCount:
          type: integer

    # å•ã„åˆã‚ã›
    InquiryRequest:
      type: object
      required:
        - vendorIds
        - name
        - email
        - message
      properties:
        vendorIds:
          type: array
          items:
            type: string
          description: å•ã„åˆã‚ã›å…ˆæ¥­è€…IDãƒªã‚¹ãƒˆ
        name:
          type: string
          example: "å±±ç”°å¤ªéƒ"
        email:
          type: string
          format: email
        phone:
          type: string
        message:
          type: string
          example: "è¦‹ç©ã‚‚ã‚Šã‚’ãŠé¡˜ã„ã—ã¾ã™"
        preferredDate:
          type: string
          format: date
          description: å¸Œæœ›æ—¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

    InquiryReceived:
      type: object
      properties:
        id:
          type: string
        customerName:
          type: string
        customerEmail:
          type: string
        customerPhone:
          type: string
        message:
          type: string
        status:
          type: string
          enum: [unread, read, replied]
        preferredDate:
          type: string
          format: date
        createdAt:
          type: string
          format: date-time

    # ã‚«ãƒ¼ãƒˆ
    Cart:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              vendor:
                $ref: '#/components/schemas/Vendor'
              service:
                $ref: '#/components/schemas/Service'
              addedAt:
                type: string
                format: date-time
        totalItems:
          type: integer
        createdAt:
          type: string
          format: date-time

    # æ¥­è€…ç™»éŒ²
    VendorRegisterRequest:
      type: object
      required:
        - name
        - email
        - password
        - categoryId
        - area
      properties:
        name:
          type: string
          example: "ç¾å®¹å®¤ã‚µãƒ³ãƒ—ãƒ«"
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          minLength: 8
        categoryId:
          type: string
        area:
          type: string
          example: "å®‡éƒ½å®®å¸‚"
        phone:
          type: string
        address:
          type: string
        description:
          type: string

    # æ¥­è€…ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
    VendorProfile:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
        category:
          $ref: '#/components/schemas/Category'
        area:
          type: string
        description:
          type: string
        address:
          type: string
        phone:
          type: string
        website:
          type: string
        status:
          type: string
          enum: [pending, approved, rejected, suspended]
        subscriptionPlan:
          type: string
          enum: [free, basic, premium]
        isInstagramConnected:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    VendorProfileUpdateRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        address:
          type: string
        phone:
          type: string
        website:
          type: string
        openingHours:
          type: object
          additionalProperties:
            type: string

    # ã‚µãƒ¼ãƒ“ã‚¹ä½œæˆ
    ServiceCreateRequest:
      type: object
      required:
        - name
        - price
      properties:
        name:
          type: string
        description:
          type: string
        price:
          type: integer
          minimum: 0
        duration:
          type: integer
          minimum: 0
        imageUrl:
          type: string
          format: uri

    # ç®¡ç†è€…ç”¨æ¥­è€…æƒ…å ±
    VendorAdmin:
      allOf:
        - $ref: '#/components/schemas/VendorProfile'
        - type: object
          properties:
            totalInquiries:
              type: integer
            totalRevenue:
              type: integer
            lastLoginAt:
              type: string
              format: date-time

    # ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
    Subscription:
      type: object
      properties:
        id:
          type: string
        vendorId:
          type: string
        plan:
          type: string
          enum: [free, basic, premium]
        status:
          type: string
          enum: [active, expired, canceled]
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        amount:
          type: integer
        nextBillingDate:
          type: string
          format: date

    # åˆ†æãƒ‡ãƒ¼ã‚¿
    Analytics:
      type: object
      properties:
        period:
          type: object
          properties:
            startDate:
              type: string
              format: date
            endDate:
              type: string
              format: date
        metrics:
          type: object
          properties:
            totalPageviews:
              type: integer
            totalInquiries:
              type: integer
            totalRevenue:
              type: integer
            activeVendors:
              type: integer
            newVendors:
              type: integer
        chartData:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              value:
                type: number

    # ã‚¦ã‚§ã‚¤ãƒˆãƒªã‚¹ãƒˆ
    WaitlistEntry:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        name:
          type: string
        businessType:
          type: string
        area:
          type: string
        status:
          type: string
          enum: [pending, contacted, converted]
        createdAt:
          type: string
          format: date-time

  # å…±é€šãƒ¬ã‚¹ãƒãƒ³ã‚¹
  responses:
    BadRequest:
      description: Bad Request - ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: "VALIDATION_ERROR"
              message: "Validation failed"
              details:
                field: "email"
                reason: "Invalid email format"

    Unauthorized:
      description: Unauthorized - èªè¨¼ãŒå¿…è¦
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: "UNAUTHORIZED"
              message: "Authentication required"

    Forbidden:
      description: Forbidden - æ¨©é™ä¸è¶³
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: "FORBIDDEN"
              message: "You don't have permission to access this resource"

    NotFound:
      description: Not Found - ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: "NOT_FOUND"
              message: "Resource not found"

    RateLimitExceeded:
      description: Too Many Requests - ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¶…é
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              code: "RATE_LIMIT_EXCEEDED"
              message: "Too many requests. Please try again later."
          headers:
            X-RateLimit-Limit:
              schema:
                type: integer
              description: ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸Šé™æ•°
            X-RateLimit-Remaining:
              schema:
                type: integer
              description: æ®‹ã‚Šãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
            X-RateLimit-Reset:
              schema:
                type: integer
              description: ãƒªã‚»ãƒƒãƒˆæ™‚åˆ»ï¼ˆUnix timestampï¼‰
